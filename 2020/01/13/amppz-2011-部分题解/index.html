<!DOCTYPE html>
<html lang="zh-Hans">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"thirtiseven.github.io","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="Looking for a challenge! 2 开坑... 网上好像只能找到 http:&#x2F;&#x2F;ruchiose.is-programmer.com&#x2F;2014&#x2F;6&#x2F;18&#x2F;main_amppz_2011_solution.48903.html 这个大佬写的一句话题解... 我太菜了，波兰题真的恐怖，我调这个东西调了三个半小时... 退役选手好像做这种稍微长一点的题就不行了 题解基本上是意译自 Lo">
<meta property="og:type" content="article">
<meta property="og:title" content="amppz 2011 部分题解">
<meta property="og:url" content="http://thirtiseven.github.io/2020/01/13/amppz-2011-%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/index.html">
<meta property="og:site_name" content="语言漩涡">
<meta property="og:description" content="Looking for a challenge! 2 开坑... 网上好像只能找到 http:&#x2F;&#x2F;ruchiose.is-programmer.com&#x2F;2014&#x2F;6&#x2F;18&#x2F;main_amppz_2011_solution.48903.html 这个大佬写的一句话题解... 我太菜了，波兰题真的恐怖，我调这个东西调了三个半小时... 退役选手好像做这种稍微长一点的题就不行了 题解基本上是意译自 Lo">
<meta property="og:locale">
<meta property="article:published_time" content="2020-01-13T13:10:54.000Z">
<meta property="article:modified_time" content="2021-12-04T07:50:17.660Z">
<meta property="article:author" content="thirtiseven">
<meta property="article:tag" content="算法题解">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://thirtiseven.github.io/2020/01/13/amppz-2011-%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-Hans'
  };
</script>

  <title>amppz 2011 部分题解 | 语言漩涡</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<style>mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

.MathJax path {
  stroke-width: 3;
}

mjx-container[display="true"] {
  overflow: auto hidden;
}

mjx-container[display="true"] + br {
  display: none;
}
</style></head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">语言漩涡</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">thirtiseven 的博客</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://thirtiseven.github.io/2020/01/13/amppz-2011-%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="thirtiseven">
      <meta itemprop="description" content="和光同尘">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="语言漩涡">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          amppz 2011 部分题解
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-01-13 21:10:54" itemprop="dateCreated datePublished" datetime="2020-01-13T21:10:54+08:00">2020-01-13</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2021-12-04 15:50:17" itemprop="dateModified" datetime="2021-12-04T15:50:17+08:00">2021-12-04</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>Looking for a challenge! 2 开坑... 网上好像只能找到 http://ruchiose.is-programmer.com/2014/6/18/main_amppz_2011_solution.48903.html 这个大佬写的一句话题解... 我太菜了，波兰题真的恐怖，我调这个东西调了三个半小时... 退役选手好像做这种稍微长一点的题就不行了 题解基本上是意译自 Looking for a challenge 2 遇到的非傻逼错误好像也就没滚动数组导致RE了... 我不知道我为啥写了这么久啊？</p>
<span id="more"></span>
<h1 id="a-arithmetic-rectangle">A Arithmetic Rectangle</h1>
<h2 id="题意">题意</h2>
<p>给出一个n*m的子矩阵，求出其最大等差子矩阵的面积。</p>
<p>等差矩阵即每行每列都为等差序列之矩阵。</p>
<p>测试组数不超过10000，n,m &lt;= 3000 元素值不超过1e9，每个测试文件大小不超过20MB</p>
<h2 id="引导问题1air-crashes">引导问题1：Air crashes</h2>
<h3 id="题意-1">题意</h3>
<p>给出一个数组a，对于每一个元素，找出其左侧最近的比它小的元素。</p>
<h3 id="解法following-the-arrows">解法：following the arrows</h3>
<p>在数组前添加一个哨兵节点，其值设为负无穷。用一个数组，称其为arrow，来维护每个元素左侧比它小的最近元素。</p>
<p>从左向右遍历数组a，若a_{i-1} &lt; a_i 则a_{i-1} 即是a_i左侧最近的比它小的元素。否则，比较 arrow[a_{i-1}] 指向的值与 ai 的大小关系，不断循环，直到找到为止。</p>
<p>此解法的时间复杂度为线性，因为每一支箭都最多只被向前移动一次。</p>
<h2 id="引导问题2plot">引导问题2：Plot</h2>
<p>给出一个01矩阵A，找出其中面积最大的全1子矩阵之面积。</p>
<h3 id="解法onm">解法：O(nm)</h3>
<p>建立一个辅助数组D，D[i,j] 表示(i,j)下方连续的1的个数，该数组可以方便地线性求得。</p>
<p>那么，对于每一个非零的D[i,j]，我们在同一行里从(i,j)出发寻找左右两侧离其最近的D[i,k]使得D[i,k]&lt;=D[i,j]。</p>
<p>计左侧点的标号为j'，右侧点的标号为j''，那么 D[i,j](j''-j'-1) 即为一个符合条件的子矩阵面积。</p>
<p>对于矩阵中的每一个元素计算上式，最大的结果即为答案，时间复杂度为O(nm)</p>
<h2 id="原问题解法">原问题解法</h2>
<p>经过观察，我们可以将一个数列分解成若干个子序列，使得每一个子序列都是等差数列。显然，相邻的两个子序列有且仅有有一个公共元素。</p>
<p>于是我们可以在线性时间内处理出从宽度为1的最大等差子矩阵，相似地，我们也可以这样处理出长度为1，宽度为2和长度为2的最大等差子矩阵。</p>
<p>下面就只剩长度和宽度都大于3的情况待解决。对于每个3*3的子矩阵，我们判断它是否为等差矩阵，如果是，则标记该子矩阵的中心元素。经过进一步观察，我们发现，如果一个子矩阵是等差矩阵，当且仅当该矩阵的每一个3*3大小的子矩阵都为等差矩阵。</p>
<p>于是，利用Plot一题中的方法，求出标记过为3*3子矩阵中心的最大子矩阵，即能求出a矩阵的最大等差子矩阵。</p>
<p>总的时间复杂度为O(nm).</p>
<h2 id="代码">代码</h2>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;climits&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">3000</span>+<span class="number">5</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> inf = INT_MIN;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T;</span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line"><span class="keyword">int</span> a[maxn][maxn], d[maxn][maxn];</span><br><span class="line"><span class="keyword">int</span> arrow_left[maxn], arrow_right[maxn];</span><br><span class="line"><span class="keyword">int</span> ans, now;</span><br><span class="line"><span class="keyword">int</span> diff, diff1, diff2;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[])</span> </span>{ </span><br><span class="line">	std::ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">	std::cin.<span class="built_in">tie</span>(<span class="number">0</span>); </span><br><span class="line">	std::cin &gt;&gt; T;</span><br><span class="line">	<span class="keyword">while</span> (T--) {</span><br><span class="line">		std::cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) {</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= m; j++) {</span><br><span class="line">				std::cin &gt;&gt; a[i][j];</span><br><span class="line">			}</span><br><span class="line">		}</span><br><span class="line">		ans = <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">if</span> (m &gt; <span class="number">1</span>) {</span><br><span class="line">			ans = std::<span class="built_in">max</span>(ans, <span class="number">2</span>);</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) {</span><br><span class="line">				now = <span class="number">2</span>;</span><br><span class="line">				diff = a[i][<span class="number">2</span>]-a[i][<span class="number">1</span>];</span><br><span class="line">				<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">3</span>; j &lt;= m; j++) {</span><br><span class="line">					<span class="keyword">if</span> (a[i][j] - a[i][j<span class="number">-1</span>] == diff) {</span><br><span class="line">						now++;</span><br><span class="line">					} <span class="keyword">else</span> {</span><br><span class="line">						diff = a[i][j] - a[i][j<span class="number">-1</span>];</span><br><span class="line">						now = <span class="number">2</span>;</span><br><span class="line">					}</span><br><span class="line">					ans = std::<span class="built_in">max</span>(ans, now);</span><br><span class="line">				}</span><br><span class="line">			}</span><br><span class="line">		}</span><br><span class="line">		<span class="keyword">if</span> (n &gt; <span class="number">1</span>) {</span><br><span class="line">			ans = std::<span class="built_in">max</span>(ans, <span class="number">2</span>);</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= m; j++) {</span><br><span class="line">				now = <span class="number">2</span>;</span><br><span class="line">				diff = a[<span class="number">2</span>][j]-a[<span class="number">1</span>][j];</span><br><span class="line">				<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">3</span>; i &lt;= n; i++) {</span><br><span class="line">					<span class="keyword">if</span> (a[i][j] - a[i<span class="number">-1</span>][j] == diff) {</span><br><span class="line">						now++;</span><br><span class="line">					} <span class="keyword">else</span> {</span><br><span class="line">						diff = a[i][j] - a[i<span class="number">-1</span>][j];</span><br><span class="line">						now = <span class="number">2</span>;</span><br><span class="line">					}</span><br><span class="line">					ans = std::<span class="built_in">max</span>(ans, now);</span><br><span class="line">				}</span><br><span class="line">			}</span><br><span class="line">		}</span><br><span class="line">		<span class="keyword">if</span> (n &gt; <span class="number">1</span> &amp;&amp; m &gt; <span class="number">1</span>) {</span><br><span class="line">			ans = std::<span class="built_in">max</span>(ans, <span class="number">4</span>);</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n<span class="number">-1</span>; i++) {</span><br><span class="line">				now = <span class="number">4</span>;</span><br><span class="line">				diff1 = a[i][<span class="number">2</span>] - a[i][<span class="number">1</span>], diff2 = a[i+<span class="number">1</span>][<span class="number">2</span>] - a[i+<span class="number">1</span>][<span class="number">1</span>];</span><br><span class="line">				<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">3</span>; j &lt;= m; j++) {</span><br><span class="line">					<span class="keyword">if</span> (a[i][j] - a[i][j<span class="number">-1</span>] == diff1 &amp;&amp; a[i+<span class="number">1</span>][j] - a[i+<span class="number">1</span>][j<span class="number">-1</span>] == diff2) {</span><br><span class="line">						now+=<span class="number">2</span>;</span><br><span class="line">					} <span class="keyword">else</span> {</span><br><span class="line">						diff1 = a[i][j] - a[i][j<span class="number">-1</span>], diff2 = a[i+<span class="number">1</span>][j] - a[i+<span class="number">1</span>][j<span class="number">-1</span>];</span><br><span class="line">						now = <span class="number">4</span>;</span><br><span class="line">					}</span><br><span class="line">					ans = std::<span class="built_in">max</span>(ans, now);</span><br><span class="line">				}</span><br><span class="line">			}</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= m<span class="number">-1</span>; j++) {</span><br><span class="line">				now = <span class="number">4</span>;</span><br><span class="line">				diff1 = a[<span class="number">2</span>][j] - a[<span class="number">1</span>][j], diff2 = a[<span class="number">2</span>][j+<span class="number">1</span>] - a[<span class="number">1</span>][j+<span class="number">1</span>];</span><br><span class="line">				<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">3</span>; i &lt;= n; i++) {</span><br><span class="line">					<span class="keyword">if</span> (a[i][j] - a[i<span class="number">-1</span>][j] == diff1 &amp;&amp; a[i][j+<span class="number">1</span>] - a[i<span class="number">-1</span>][j+<span class="number">1</span>] == diff2) {</span><br><span class="line">						now+=<span class="number">2</span>;</span><br><span class="line">					} <span class="keyword">else</span> {</span><br><span class="line">						diff1 = a[i][j] - a[i<span class="number">-1</span>][j], diff2 = a[i][j+<span class="number">1</span>] - a[i<span class="number">-1</span>][j+<span class="number">1</span>];</span><br><span class="line">						now = <span class="number">4</span>;</span><br><span class="line">					}</span><br><span class="line">					ans = std::<span class="built_in">max</span>(ans, now);</span><br><span class="line">				}</span><br><span class="line">			}</span><br><span class="line">		}</span><br><span class="line">		<span class="keyword">if</span> (n &gt;= <span class="number">3</span> &amp;&amp; m &gt;= <span class="number">3</span>) {</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; i++) {</span><br><span class="line">				<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= m; j++) {</span><br><span class="line">					d[i][j] = <span class="number">0</span>;</span><br><span class="line">				}</span><br><span class="line">			}</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = n<span class="number">-1</span>; i &gt;= <span class="number">2</span>; i--) {</span><br><span class="line">				<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">2</span>; j &lt;= m<span class="number">-1</span>; j++) {</span><br><span class="line">					<span class="keyword">int</span> yes = <span class="number">1</span>;</span><br><span class="line">					<span class="keyword">if</span> (a[i<span class="number">-1</span>][j+<span class="number">1</span>] - a[i<span class="number">-1</span>][j] != a[i<span class="number">-1</span>][j] - a[i<span class="number">-1</span>][j<span class="number">-1</span>]) {</span><br><span class="line">						yes = <span class="number">0</span>;</span><br><span class="line">					}</span><br><span class="line">					<span class="keyword">if</span> (a[i][j+<span class="number">1</span>] - a[i][j] != a[i][j] - a[i][j<span class="number">-1</span>]) {</span><br><span class="line">						yes = <span class="number">0</span>;</span><br><span class="line">					}</span><br><span class="line">					<span class="keyword">if</span> (a[i+<span class="number">1</span>][j+<span class="number">1</span>] - a[i+<span class="number">1</span>][j] != a[i+<span class="number">1</span>][j] - a[i+<span class="number">1</span>][j<span class="number">-1</span>]) {</span><br><span class="line">						yes = <span class="number">0</span>;</span><br><span class="line">					}</span><br><span class="line">					<span class="keyword">if</span> (a[i+<span class="number">1</span>][j<span class="number">-1</span>] - a[i][j<span class="number">-1</span>] != a[i][j<span class="number">-1</span>] - a[i<span class="number">-1</span>][j<span class="number">-1</span>]) {</span><br><span class="line">						yes = <span class="number">0</span>;</span><br><span class="line">					}</span><br><span class="line">					<span class="keyword">if</span> (a[i+<span class="number">1</span>][j] - a[i][j] != a[i][j] - a[i<span class="number">-1</span>][j]) {</span><br><span class="line">						yes = <span class="number">0</span>;</span><br><span class="line">					}</span><br><span class="line">					<span class="keyword">if</span> (a[i+<span class="number">1</span>][j+<span class="number">1</span>] - a[i][j+<span class="number">1</span>] != a[i][j+<span class="number">1</span>] - a[i<span class="number">-1</span>][j+<span class="number">1</span>]) {</span><br><span class="line">						yes = <span class="number">0</span>;</span><br><span class="line">					}</span><br><span class="line">					<span class="keyword">if</span> (yes) {</span><br><span class="line">						d[i][j] = d[i+<span class="number">1</span>][j] + <span class="number">1</span>;</span><br><span class="line">					} <span class="keyword">else</span> {</span><br><span class="line">						d[i][j] = <span class="number">0</span>;</span><br><span class="line">					}</span><br><span class="line">				}</span><br><span class="line">			}</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n<span class="number">-1</span>; i++) {</span><br><span class="line">				d[i][<span class="number">1</span>] = inf;</span><br><span class="line">				d[i][m] = inf;</span><br><span class="line">				<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">2</span>; j &lt;= m<span class="number">-1</span>; j++) {</span><br><span class="line">					<span class="keyword">if</span> (d[i][j<span class="number">-1</span>] &lt; d[i][j]) {</span><br><span class="line">						arrow_left[j] = j<span class="number">-1</span>;</span><br><span class="line">					} <span class="keyword">else</span> {</span><br><span class="line">						arrow_left[j] = arrow_left[j<span class="number">-1</span>];</span><br><span class="line">						<span class="keyword">while</span> (d[i][arrow_left[j]] &gt;= d[i][j]) {</span><br><span class="line">							arrow_left[j] = arrow_left[arrow_left[j]];</span><br><span class="line">						}</span><br><span class="line">					}</span><br><span class="line">				}</span><br><span class="line">				<span class="keyword">for</span> (<span class="keyword">int</span> j = m<span class="number">-1</span>; j &gt;= <span class="number">2</span>; j--) {</span><br><span class="line">					<span class="keyword">if</span> (d[i][j+<span class="number">1</span>] &lt; d[i][j]) {</span><br><span class="line">						arrow_right[j] = j+<span class="number">1</span>;</span><br><span class="line">					} <span class="keyword">else</span> {</span><br><span class="line">						arrow_right[j] = arrow_right[j+<span class="number">1</span>];</span><br><span class="line">						<span class="keyword">while</span> (d[i][arrow_right[j]] &gt;= d[i][j]) {</span><br><span class="line">							arrow_right[j] = arrow_right[arrow_right[j]];</span><br><span class="line">						}</span><br><span class="line">					}</span><br><span class="line">				}</span><br><span class="line">				<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">2</span>; j &lt;= m<span class="number">-1</span>; j++) {</span><br><span class="line">					<span class="keyword">if</span> (d[i][j] &gt; <span class="number">0</span>) ans = std::<span class="built_in">max</span>(ans, (d[i][j]+<span class="number">2</span>)*(arrow_right[j]-arrow_left[j]+<span class="number">1</span>));</span><br><span class="line">				}</span><br><span class="line">			}</span><br><span class="line">		}</span><br><span class="line">		std::cout &lt;&lt; ans &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">	}</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h1 id="b-bytean-road-race">B Bytean Road Race</h1>
<p>翻了翻Claris的博客，果然发现Claris的博客里写满了题解 orz Claris 存个链接 https://www.cnblogs.com/clrs97/p/8861303.html 不过这个题我的代码是写的O(n)的那个方法。 在昨天那个题交了38发之后，今天一发就过了！平均每题只交了不到二十发... 以及在昨天被卡空间之后，今天写题之前测了下空间能不能开的下。 摸索出了新的卡空间技巧，图和点都开成局部变量，用完就扔。 虽然倍增我不会，但是写过O(n)的就不想再写O(nlogn)的了（逃</p>
<h2 id="题意-2">题意</h2>
<p>一张网格图中一些线段被标出，跑步选手可以从左上到右下选择路线跑步。多次询问两个节点，判断是否有能经过这两个节点的跑步路线。</p>
<h2 id="解法onlogn">解法：O(nlogn)</h2>
<p>先把网格向旋转135度，现在它变成了一个根在下面的DAG。</p>
<p>定义左路径是从一个点出发尽可能向左走的路径，右路径是从一个点出发尽可能向右走的路径。</p>
<p>如果p和q之间有路径，那么做一条经过点q的水平线，则：</p>
<p>从p出发的左路径与水平线的交点要么是q，要么在q左侧；从p出发的右路径和水平线的交点要么是q，要么在q右侧。</p>
<h3 id="左右路径的结构倍增">左右路径的结构：倍增</h3>
<p>构造二维数组left，对于每个v和i &lt;=log2n，left[i,j] 表示从v出发沿着左路径走2^i步能到达的点的标号。同理构造right。然后我们可以在O(nlogn)时间内计算出left和right的值。</p>
<p>left[u,i]:=left[left[u,i-1],i-1].</p>
<p>然后，就可以计算出left和right与水平线的交点，进而在log时间内回答每次询问。</p>
<h2 id="引导问题树上相互的位置">引导问题：树上相互的位置</h2>
<p>给一颗二叉树，询问某两个点的位置关系：高低左右</p>
<p>（高低指是否是直系亲属）</p>
<h3 id="解法">解法</h3>
<p>深度优先搜索，记录每个点第一次被访问的时间 I 和访问完其所有子节点后离开它的时间O。</p>
<p>a 高于 b 当且仅当 Ia &lt; Ib 且 Ob &lt; Oa</p>
<p>a 在 b 的左边当且仅当 Oa &lt; Ib</p>
<h2 id="解法on">解法：O(n)</h2>
<p>将所有左路径建成一颗树，将所有右路径也建成一棵树。注意，此时所有的边都汇入终点，因此它的根就是最后一个交叉点。在翻转的图形中，正好形成了一个有根树。</p>
<p>经过观察，我们发现在左树中如果p在q的右侧，则从p出发的做路径与水平线的交点在q的右侧。反之亦然。于是便可以在常数时间内回答每次询问。</p>
<p>总的时间复杂度为 O(n)。</p>
<h2 id="代码-1">代码</h2>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">100000</span>+<span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, m, k;</span><br><span class="line"><span class="keyword">int</span> u, v;</span><br><span class="line">std::pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; tl[maxn], tr[maxn];</span><br><span class="line"><span class="keyword">int</span> inl[maxn], inr[maxn], outl[maxn], outr[maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">inti</span><span class="params">()</span> </span>{</span><br><span class="line">	std::cin &gt;&gt; n &gt;&gt; m &gt;&gt; k;</span><br><span class="line">	std::pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; p[n+<span class="number">1</span>];</span><br><span class="line">	std::vector&lt;<span class="keyword">int</span>&gt; g[n+<span class="number">1</span>];</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) {</span><br><span class="line">		std::cin &gt;&gt; p[i].first &gt;&gt; p[i].second;</span><br><span class="line">	}</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++) {</span><br><span class="line">		std::cin &gt;&gt; u &gt;&gt; v;</span><br><span class="line">		g[u].<span class="built_in">push_back</span>(v);</span><br><span class="line">		g[v].<span class="built_in">push_back</span>(u);</span><br><span class="line">	}</span><br><span class="line">	<span class="keyword">int</span> nextl, nextr;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) {</span><br><span class="line">		tl[i] = tr[i] = std::<span class="built_in">make_pair</span>(<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">	}</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) {</span><br><span class="line">		nextl = nextr = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">auto</span> it: g[i]) {</span><br><span class="line">			<span class="keyword">if</span> (p[it].first &gt; p[i].first) {</span><br><span class="line">				nextl = it;</span><br><span class="line">			}</span><br><span class="line">			<span class="keyword">if</span> (p[it].second &lt; p[i].second) {</span><br><span class="line">				nextr = it;</span><br><span class="line">			}</span><br><span class="line">		}</span><br><span class="line">		<span class="keyword">if</span> (nextr == <span class="number">0</span>) {</span><br><span class="line">			nextr = nextl;</span><br><span class="line">		}</span><br><span class="line">		<span class="keyword">if</span> (nextl == <span class="number">0</span>) {</span><br><span class="line">			nextl = nextr;</span><br><span class="line">		}</span><br><span class="line"> 		<span class="keyword">if</span> (p[nextl].second == p[i].second) {</span><br><span class="line">			tl[nextl].first = i;</span><br><span class="line">		} <span class="keyword">else</span> {</span><br><span class="line">			tl[nextl].second = i;</span><br><span class="line">		}</span><br><span class="line">		<span class="keyword">if</span> (p[nextr].second == p[i].second) {</span><br><span class="line">			tr[nextr].first = i;</span><br><span class="line">		} <span class="keyword">else</span> {</span><br><span class="line">			tr[nextr].second = i;</span><br><span class="line">		}</span><br><span class="line">	}</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> cur;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfsl</span><span class="params">(<span class="keyword">int</span> now)</span> </span>{</span><br><span class="line">	cur++;</span><br><span class="line">	inl[now] = cur;</span><br><span class="line">	<span class="keyword">if</span> (tl[now].first != <span class="number">0</span>) {</span><br><span class="line">		<span class="built_in">dfsl</span>(tl[now].first);</span><br><span class="line">	}</span><br><span class="line">	<span class="keyword">if</span> (tl[now].second != <span class="number">0</span>) {</span><br><span class="line">		<span class="built_in">dfsl</span>(tl[now].second);</span><br><span class="line">	}</span><br><span class="line">	cur++;</span><br><span class="line">	outl[now] = cur;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfsr</span><span class="params">(<span class="keyword">int</span> now)</span> </span>{</span><br><span class="line">	cur++;</span><br><span class="line">	inr[now] = cur;</span><br><span class="line">	<span class="keyword">if</span> (tr[now].first != <span class="number">0</span>) {</span><br><span class="line">		<span class="built_in">dfsr</span>(tr[now].first);</span><br><span class="line">	}</span><br><span class="line">	<span class="keyword">if</span> (tr[now].second != <span class="number">0</span>) {</span><br><span class="line">		<span class="built_in">dfsr</span>(tr[now].second);</span><br><span class="line">	}</span><br><span class="line">	cur++;</span><br><span class="line">	outr[now] = cur;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[])</span> </span>{  </span><br><span class="line">	std::ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">	std::cin.<span class="built_in">tie</span>(<span class="number">0</span>); </span><br><span class="line">	<span class="built_in">inti</span>();</span><br><span class="line">	cur = <span class="number">0</span>;</span><br><span class="line">	<span class="built_in">dfsl</span>(n);</span><br><span class="line">	cur = <span class="number">0</span>;</span><br><span class="line">	<span class="built_in">dfsr</span>(n);	</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= k; i++) {</span><br><span class="line">		std::cin &gt;&gt; u &gt;&gt; v;</span><br><span class="line">		<span class="keyword">bool</span> yes = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">if</span> (inl[v] &lt; inl[u] &amp;&amp; outl[v] &gt; outl[u]) {</span><br><span class="line">			yes = <span class="number">1</span>;</span><br><span class="line">		}</span><br><span class="line">		<span class="keyword">if</span> (inr[v] &lt; inr[u] &amp;&amp; outr[v] &gt; outr[u]) {</span><br><span class="line">			yes = <span class="number">1</span>;</span><br><span class="line">		}</span><br><span class="line">		<span class="keyword">if</span> (inl[u] &lt; inl[v] &amp;&amp; outl[u] &gt; outl[v]) {</span><br><span class="line">			yes = <span class="number">1</span>;</span><br><span class="line">		}</span><br><span class="line">		<span class="keyword">if</span> (inr[u] &lt; inr[v] &amp;&amp; outr[u] &gt; outr[v]) {</span><br><span class="line">			yes = <span class="number">1</span>;</span><br><span class="line">		}</span><br><span class="line">		<span class="keyword">if</span> (outl[v] &lt; inl[u] &amp;&amp; outr[u] &lt; inr[v]) {</span><br><span class="line">			yes = <span class="number">1</span>;</span><br><span class="line">		}</span><br><span class="line">		<span class="keyword">if</span> (outl[u] &lt; inl[v] &amp;&amp; outr[v] &lt; inr[u]) {</span><br><span class="line">			yes = <span class="number">1</span>;</span><br><span class="line">		}</span><br><span class="line">		<span class="keyword">if</span> (yes) {</span><br><span class="line">			std::cout &lt;&lt; <span class="string">"TAK\n"</span>;</span><br><span class="line">		} <span class="keyword">else</span> {</span><br><span class="line">			std::cout &lt;&lt; <span class="string">"NIE\n"</span>;</span><br><span class="line">		}</span><br><span class="line">	}</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h1 id="e-gophers">E Gophers</h1>
<p>发现cf上竟然有这套题... 以及发现coach mode的提交不算在submission里面，奥妙重重 coach mode真香！D不想写，翻了翻其他人代码，收获一个看上去非常优雅的分数类板子。 这个E好像挺水的... 线段树区间合并的做法什么时候补一下吧（什么时候 等我学会线段树</p>
<h2 id="题意-3">题意</h2>
<p>数轴上有一些住着人的洞窟，有一个人试图用m台CD机播放摇滚音乐来打扰洞窟里的住民。每台CD机可以影响的范围为l。CD机的主人会移动一台CD机。每次移动后，询问有多少个洞窟会受到音乐的影响。</p>
<h2 id="解法-1">解法</h2>
<p>由于区间等长，把区间中点扔进set里，每次修改找前驱和后继查询一下受影响的点有几个，删点，查询一下修改后位置前驱后继看看受影响的点有几个，加点。维护答案。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">500000</span>+<span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, m, d, l;</span><br><span class="line"><span class="keyword">int</span> x[maxn];</span><br><span class="line">std::set&lt;<span class="keyword">int</span>&gt; z;</span><br><span class="line"><span class="keyword">int</span> p, r;</span><br><span class="line"><span class="keyword">int</span> zz;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[])</span> </span>{  </span><br><span class="line">	std::ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">	std::cin.<span class="built_in">tie</span>(<span class="number">0</span>); </span><br><span class="line">	std::cin &gt;&gt; n &gt;&gt; m &gt;&gt; d &gt;&gt; l;</span><br><span class="line">	x[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; i++) {</span><br><span class="line">		std::cin &gt;&gt; x[i];</span><br><span class="line">	}</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) {</span><br><span class="line">		std::cin &gt;&gt; zz;</span><br><span class="line">		z.<span class="built_in">insert</span>(zz);</span><br><span class="line">	}</span><br><span class="line">	z.<span class="built_in">insert</span>(<span class="number">-1000000007</span>);</span><br><span class="line">	z.<span class="built_in">insert</span>(<span class="number">2000000007</span>);</span><br><span class="line">	<span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) {</span><br><span class="line">		<span class="keyword">auto</span> it1 = z.<span class="built_in">lower_bound</span>(x[i]);</span><br><span class="line">		<span class="keyword">auto</span> it2 = it1;</span><br><span class="line">		it2--;</span><br><span class="line">		<span class="keyword">if</span> (std::<span class="built_in">abs</span>(*it1-x[i]) &lt;= l || std::<span class="built_in">abs</span>(*it2-x[i]) &lt;= l) {</span><br><span class="line">			ans++;</span><br><span class="line">		}</span><br><span class="line">	}</span><br><span class="line">	std::cout &lt;&lt; ans &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">	<span class="keyword">int</span> left, right, ll, rr;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; d; i++) {</span><br><span class="line">		std::cin &gt;&gt; p &gt;&gt; r;</span><br><span class="line">		<span class="keyword">auto</span> it1 = z.<span class="built_in">lower_bound</span>(p);</span><br><span class="line">		<span class="keyword">auto</span> it2 = it1;</span><br><span class="line">		it1++;</span><br><span class="line">		it2--;</span><br><span class="line">		left = std::<span class="built_in">max</span>(*it2+l+<span class="number">1</span>, p-l);</span><br><span class="line">		right = std::<span class="built_in">min</span>(*it1-l<span class="number">-1</span>, p+l);</span><br><span class="line">		ll = std::<span class="built_in">lower_bound</span>(x+<span class="number">1</span>, x+n+<span class="number">1</span>, left)-(x+<span class="number">1</span>);</span><br><span class="line">		rr = std::<span class="built_in">lower_bound</span>(x+<span class="number">1</span>, x+n+<span class="number">1</span>, right+<span class="number">1</span>)-(x+<span class="number">1</span>);</span><br><span class="line">		ans -= std::<span class="built_in">max</span>(<span class="number">0</span>, rr-ll);</span><br><span class="line">		z.<span class="built_in">erase</span>(p);</span><br><span class="line">		<span class="keyword">auto</span> it3 = z.<span class="built_in">lower_bound</span>(r);</span><br><span class="line">		<span class="keyword">auto</span> it4 = it3;</span><br><span class="line">		it4--;</span><br><span class="line">		left = std::<span class="built_in">max</span>(*it4+l+<span class="number">1</span>, r-l);</span><br><span class="line">		right = std::<span class="built_in">min</span>(*it3-l<span class="number">-1</span>, r+l);</span><br><span class="line">		ll = std::<span class="built_in">lower_bound</span>(x+<span class="number">1</span>, x+n+<span class="number">1</span>, left)-(x+<span class="number">1</span>);</span><br><span class="line">		rr = std::<span class="built_in">lower_bound</span>(x+<span class="number">1</span>, x+n+<span class="number">1</span>, right+<span class="number">1</span>)-(x+<span class="number">1</span>);</span><br><span class="line">		ans += std::<span class="built_in">max</span>(<span class="number">0</span>, rr-ll);</span><br><span class="line">		std::cout &lt;&lt; ans &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">		z.<span class="built_in">insert</span>(r);</span><br><span class="line">	}</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h1 id="f-laundry">F Laundry</h1>
<p>贪心水题，没仔细看题解</p>
<h3 id="题意-4">题意</h3>
<p>几个人的衣服要晾晒。挂衣夹满足如下要求：</p>
<ul>
<li>一只袜子用一个衣夹</li>
<li>一件T恤用三个衣夹</li>
<li>一个人的袜子用同一种颜色</li>
<li>一个人的T恤用同一种颜色</li>
<li>两个人的衣服不能是同一种颜色</li>
<li>需要的衣夹颜色最少</li>
</ul>
<p>给出一大堆衣夹，算出谁应该用哪种衣夹。</p>
<h3 id="题解">题解</h3>
<p>全扔进set里面贪心。每次从待洗的衣服里优先拿拆分后的最大的，然后拿没拆分过的最大的，每次从衣夹里取能取的最小的，取不到的话就拆分，拆不了就无解。</p>
<h3 id="代码-2">代码</h3>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, k;</span><br><span class="line">std::multiset&lt;<span class="keyword">int</span>&gt; l;</span><br><span class="line">std::priority_queue&lt;std::pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;&gt; d;</span><br><span class="line"><span class="keyword">int</span> t;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[])</span> </span>{  </span><br><span class="line">	std::ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">	std::cin.<span class="built_in">tie</span>(<span class="number">0</span>); </span><br><span class="line">	std::cin &gt;&gt; n &gt;&gt; k;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) {</span><br><span class="line">		std::cin &gt;&gt; t;</span><br><span class="line">		d.<span class="built_in">push</span>(std::<span class="built_in">make_pair</span>(<span class="number">0</span>, t*<span class="number">5</span>));</span><br><span class="line">	}</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; k; i++) {</span><br><span class="line">		std::cin &gt;&gt; t;</span><br><span class="line">		l.<span class="built_in">insert</span>(t);</span><br><span class="line">	}</span><br><span class="line">	l.<span class="built_in">insert</span>(<span class="number">6000000</span>);</span><br><span class="line">	<span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span> (!d.<span class="built_in">empty</span>()) {</span><br><span class="line">		std::pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; x = d.<span class="built_in">top</span>();</span><br><span class="line">		d.<span class="built_in">pop</span>();</span><br><span class="line">		<span class="keyword">auto</span> it = l.<span class="built_in">lower_bound</span>(x.second);</span><br><span class="line">		<span class="keyword">if</span> (*it == <span class="number">6000000</span>) {</span><br><span class="line">			<span class="keyword">if</span> (x.first == <span class="number">0</span>) {</span><br><span class="line">				d.<span class="built_in">push</span>(std::<span class="built_in">make_pair</span>(<span class="number">1</span>, x.second/<span class="number">5</span>*<span class="number">3</span>));</span><br><span class="line">				d.<span class="built_in">push</span>(std::<span class="built_in">make_pair</span>(<span class="number">1</span>, x.second/<span class="number">5</span>*<span class="number">2</span>));</span><br><span class="line">			} <span class="keyword">else</span> {</span><br><span class="line">				std::cout &lt;&lt; <span class="string">"NIE\n"</span>;</span><br><span class="line">				<span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">			}</span><br><span class="line">		} <span class="keyword">else</span> {</span><br><span class="line">			l.<span class="built_in">erase</span>(it);</span><br><span class="line">			ans++;</span><br><span class="line">		}</span><br><span class="line">	}</span><br><span class="line">	std::cout &lt;&lt; ans &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E7%AE%97%E6%B3%95%E9%A2%98%E8%A7%A3/" rel="tag"># 算法题解</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2019/11/25/%E9%80%80%E5%BD%B9%E9%80%89%E6%89%8B%E4%B8%A2%E4%BA%BA%E8%AE%A1%E5%88%92/" rel="prev" title="退役选手丢人计划">
      <i class="fa fa-chevron-left"></i> 退役选手丢人计划
    </a></div>
      <div class="post-nav-item">
    <a href="/2020/01/20/%E5%AD%A6%E4%B9%A0python/" rel="next" title="系统学习了一下python">
      系统学习了一下python <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#a-arithmetic-rectangle"><span class="nav-number">1.</span> <span class="nav-text">A Arithmetic Rectangle</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%A2%98%E6%84%8F"><span class="nav-number">1.1.</span> <span class="nav-text">题意</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BC%95%E5%AF%BC%E9%97%AE%E9%A2%981air-crashes"><span class="nav-number">1.2.</span> <span class="nav-text">引导问题1：Air crashes</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E6%84%8F-1"><span class="nav-number">1.2.1.</span> <span class="nav-text">题意</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A7%A3%E6%B3%95following-the-arrows"><span class="nav-number">1.2.2.</span> <span class="nav-text">解法：following the arrows</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BC%95%E5%AF%BC%E9%97%AE%E9%A2%982plot"><span class="nav-number">1.3.</span> <span class="nav-text">引导问题2：Plot</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A7%A3%E6%B3%95onm"><span class="nav-number">1.3.1.</span> <span class="nav-text">解法：O(nm)</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8E%9F%E9%97%AE%E9%A2%98%E8%A7%A3%E6%B3%95"><span class="nav-number">1.4.</span> <span class="nav-text">原问题解法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81"><span class="nav-number">1.5.</span> <span class="nav-text">代码</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#b-bytean-road-race"><span class="nav-number">2.</span> <span class="nav-text">B Bytean Road Race</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%A2%98%E6%84%8F-2"><span class="nav-number">2.1.</span> <span class="nav-text">题意</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%A7%A3%E6%B3%95onlogn"><span class="nav-number">2.2.</span> <span class="nav-text">解法：O(nlogn)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B7%A6%E5%8F%B3%E8%B7%AF%E5%BE%84%E7%9A%84%E7%BB%93%E6%9E%84%E5%80%8D%E5%A2%9E"><span class="nav-number">2.2.1.</span> <span class="nav-text">左右路径的结构：倍增</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BC%95%E5%AF%BC%E9%97%AE%E9%A2%98%E6%A0%91%E4%B8%8A%E7%9B%B8%E4%BA%92%E7%9A%84%E4%BD%8D%E7%BD%AE"><span class="nav-number">2.3.</span> <span class="nav-text">引导问题：树上相互的位置</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A7%A3%E6%B3%95"><span class="nav-number">2.3.1.</span> <span class="nav-text">解法</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%A7%A3%E6%B3%95on"><span class="nav-number">2.4.</span> <span class="nav-text">解法：O(n)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81-1"><span class="nav-number">2.5.</span> <span class="nav-text">代码</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#e-gophers"><span class="nav-number">3.</span> <span class="nav-text">E Gophers</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%A2%98%E6%84%8F-3"><span class="nav-number">3.1.</span> <span class="nav-text">题意</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%A7%A3%E6%B3%95-1"><span class="nav-number">3.2.</span> <span class="nav-text">解法</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#f-laundry"><span class="nav-number">4.</span> <span class="nav-text">F Laundry</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E6%84%8F-4"><span class="nav-number">4.0.1.</span> <span class="nav-text">题意</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E8%A7%A3"><span class="nav-number">4.0.2.</span> <span class="nav-text">题解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81-2"><span class="nav-number">4.0.3.</span> <span class="nav-text">代码</span></a></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">thirtiseven</p>
  <div class="site-description" itemprop="description">和光同尘</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">59</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
        <span class="site-state-item-count">9</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">thirtiseven</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
